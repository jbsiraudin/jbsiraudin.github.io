"use strict";(self.webpackChunkjb_blog=self.webpackChunkjb_blog||[]).push([[5690],{8313:(e,t,a)=>{a.d(t,{Z:()=>s});var n=a(7294);const s=function(e){let{srcUrl:t,width:a=560,height:s=315,legend:i=""}=e;return n.createElement(n.Fragment,null,n.createElement("div",{style:{display:"flex",justifyContent:"center",margin:"auto",marginBottom:"30px"}},n.createElement("iframe",{className:"illustration",width:a,height:s,src:t,frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})),n.createElement("p",{style:{fontSize:"small",textAlign:"center",marginTop:"-20px"}},i))}},7993:(e,t,a)=>{a.d(t,{Z:()=>i});var n=a(7294),s=a(4996);const i=function(e){let{srcImage:t,legend:a="",altText:i="",halfWidth:r=!1}=e;return n.createElement(n.Fragment,null,n.createElement("div",{style:{width:"fit-content",display:"flex",margin:"auto",marginBottom:"30px"}},n.createElement("img",{alt:i,style:{width:r?"400px":"auto",margin:"auto"},src:(0,s.Z)(t)})),n.createElement("p",{style:{fontSize:"small",textAlign:"center",marginTop:"-20px"}},a))}},1957:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>j,contentTitle:()=>B,default:()=>R,frontMatter:()=>H,metadata:()=>U,toc:()=>O});var n=a(7462),s=a(7294),i=a(3905),r=a(5697),l=a.n(r),o=a(6486),c=a.n(o);class h{constructor(e,t){this.n=e,this.timeline=new Array(e),this.entropies=new Array(e),this.tiles=new Array(t.length),this.n_tiles=t.length;for(let a=0;a<t.length;a++){const n=t[a];this.tiles[a]={id:n.id,cid:n.cid,label:n.label,color:n.color,weights:new Array(e).fill(1)}}this.wave=new Array(e),this.wavefront=new Array(e).fill(!1),this.wave_save=new Array(e),this.constraints_propagator=[new Array(this.n_tiles).fill(new Array(this.n_tiles).fill(!0)),new Array(this.n_tiles).fill(new Array(this.n_tiles).fill(!0))],this.preferences_propagator=[],this.ready=!1,this.DEBUG_LOGS=!1}init(){this.setupWave()}getWave(){return this.wave}getTimeline(){return this.timeline}reset(){this.setupWave(),this.timeline=new Array(this.n)}resetConstraints(){this.constraints_propagator=[new Array(this.n_tiles).fill(new Array(this.n_tiles).fill(!0)),new Array(this.n_tiles).fill(new Array(this.n_tiles).fill(!0))]}setupWave(){this.wave=new Array(this.n),this.wavefront=new Array(this.n).fill(!1);for(let e=0;e<this.n;e++){this.wave[e]=[];for(let t=0;t<this.tiles.length;t++)this.tiles[t].weights[e]>0&&this.wave[e].push({id:this.tiles[t].id,cid:this.tiles[t].cid,label:this.tiles[t].label,color:this.tiles[t].color,weights:this.tiles[t].weights[e],distribution:0})}}setupPropagators(){this.constraints_propagator=[new Array(this.n_tiles).fill(new Array(this.n_tiles).fill(!0)),new Array(this.n_tiles).fill(new Array(this.n_tiles).fill(!0))]}applyConstraint(e,t,a){for(let n=0;n<e.length;n++)for(let s=0;s<a.length;s++)this.addConstraint(e[n],t,a[s])}addConstraint(e,t,a){this.constraints_propagator[t][e][a]=!1,this.constraints_propagator[(t+1)%2][a][e]=!1}resetWeights(){for(let e=0;e<this.tiles.length;e++)this.tiles[e].weights=new Array(this.n).fill(1)}applyWeight(e,t,a){for(let n=0;n<e.length;n++)this.tiles[e[n]].weights[t[0]]=a}computeEntropy(){for(let e=0;e<this.n;e++){if(this.wavefront[e]){this.entropies[e]=1e8;continue}const t=this.wave[e];let a=0;for(let e=0;e<t.length;e++)a+=t[e].weights;let n=0;for(let e=0;e<t.length;e++){const s=t[e].weights/a;t[e].distribution=s,0!==s&&(n-=s*Math.log(s))}this.entropies[e]=c().round(n,5)}}observe(){let e=Number.MAX_VALUE,t=-1,a=[];for(let n=0;n<this.n;n++){if(this.wavefront[n])continue;const s=this.entropies[n];s<e?(e=s,t=0,a=[n]):s===e&&a.push(n)}if(-1===t)throw console.error("ENTROPIES WRONGLY COMPUTED");return a[c().random(a.length-1)]}isDone(){let e=!0;for(let t=0;t<this.n;t++)if(!this.wavefront[t]){e=!1;break}return e}propagate(e,t){this.timeline[e]=this.wave[e][t];const a=this.wave[e][t].id;this.wave[e]=this.wave[e][t],this.wavefront[e]=!0;let n=0;if(e>0&&!1===this.wavefront[e-1]){const t=this.constraints_propagator[0][a];c().remove(this.wave[e-1],(function(e){return!t[e.id]&&(n+=1,!0)}))}if(e<this.n-1&&!1===this.wavefront[e+1]){const t=this.constraints_propagator[1][a];c().remove(this.wave[e+1],(function(e){return!t[e.id]&&(n+=1,!0)}))}return n}step(){this.computeEntropy();const e=this.observe(),t=function(e){let t=0,a=Math.random();for(;a>0;)a-=e[t].distribution,t++;return t--,t}(this.wave[e]),a=this.propagate(e,t);this.DEBUG_LOGS&&console.log(`The tile ${t} was placed at the spot ${e}, ${a} elements were removed from a potential spot during propagation`)}run(){for(;!this.isDone();)this.step()}slowRun(e){for(;!this.isDone();)setTimeout(this.step(),e)}}class d{constructor(e,t){this.n=e,this.timeline=new Array(e),this.deck=[...t],this.DEBUG_LOGS=!1}getTimeline(){return this.timeline}run(){for(let e=0;e<this.n;e++){const t=c().random(this.deck.length-1);this.timeline[e]=this.deck[t]}}}class m{constructor(e,t){this.n=e,this.timeline=new Array(e),this.deck=[...t],this.deck_save=[...t],this.DEBUG_LOGS=!1}reset(){this.deck=[...this.deck_save]}getTimeline(){return this.timeline}run(){for(let e=0;e<this.n;e++){const t=c().random(this.deck.length-1);this.timeline[e]=this.deck[t],c().pullAt(this.deck,[t])}}}class u{constructor(e,t){this.n=e,this.timeline=new Array(e),this.tiles=new Array(t.length);for(let a=0;a<t.length;a++){const e=t[a];this.tiles[a]={id:e.id,cid:e.cid,weight:1}}this.deck=[...t],this.DEBUG_LOGS=!1}reset(){this.timeline=new Array(this.n)}resetWeights(){for(let e=0;e<this.tiles.length;e++)this.tiles[e].weight=1}applyWeight(e,t){this.tiles[e].weight=t}resetWeight(e){this.tiles[e].weight=1}getTimeline(){return this.timeline}run(){let e=0;for(let t=0;t<this.tiles.length;t++)e+=this.tiles[t].weight;console.log(this.tiles),console.log(e);for(let t=0;t<this.n;t++){const a=c().random(e);let n=0;for(let e=0;e<this.tiles.length;e++)if(n+=this.tiles[e].weight,n>a){this.timeline[t]=this.tiles[e];break}}}}const p=20,g={cid:"00",label:"",color:"#fff"},f=["s","h","d","c"],k=["Spades","Hearts","Diamonds","Clubs"];function y(e,t){let a="";return a=11===t?"Jack of ":12===t?"Queen of ":13===t?"King of ":`${t} of `,a+=k[e],a}function v(e,t){let a="";return a=11===t?"J":12===t?"Q":13===t?"K":`${t}`,a+=f[e],a}const w=[];for(let z=0;z<4;z++)for(let e=1;e<14;e++)w.push({id:13*z+e-1,cid:v(z,e),label:y(z,e),color:"#868686"});new Array(p).fill(1),new Array(p).fill(1),new Array(p).fill(1),new Array(p).fill(1),new Array(p).fill(1),new Array(p).fill(1),new Array(p).fill(1);const b=[{key:"any",text:"Any",value:"0"},{key:"ace",text:"Ace",value:"1"},{key:"2",text:"2",value:"2"},{key:"3",text:"3",value:"3"},{key:"4",text:"4",value:"4"},{key:"5",text:"5",value:"5"},{key:"6",text:"6",value:"6"},{key:"7",text:"7",value:"7"},{key:"8",text:"8",value:"8"},{key:"9",text:"9",value:"9"},{key:"10",text:"10",value:"10"},{key:"jack",text:"Jack",value:"J"},{key:"queen",text:"Queen",value:"Q"},{key:"king",text:"King",value:"K"}],E=[{key:"0",text:"Suit",value:"0",color:"#495057"},{key:"s",text:"\u2660\ufe0f",value:"s",color:"black"},{key:"h",text:"\u2665\ufe0f",value:"h",color:"red"},{key:"h",text:"\u2666\ufe0f",value:"d",color:"red"},{key:"c",text:"\u2663\ufe0f",value:"c",color:"black"}],x=[{key:"0",text:"1",value:"0"},{key:"1",text:"2",value:"1"},{key:"2",text:"3",value:"2"},{key:"3",text:"4",value:"3"},{key:"4",text:"5",value:"4"},{key:"5",text:"6",value:"5"},{key:"6",text:"7",value:"6"},{key:"7",text:"8",value:"7"},{key:"8",text:"9",value:"8"},{key:"9",text:"10",value:"9"},{key:"10",text:"11",value:"10"},{key:"11",text:"12",value:"11"},{key:"12",text:"13",value:"12"},{key:"13",text:"14",value:"13"},{key:"14",text:"15",value:"14"},{key:"15",text:"16",value:"15"},{key:"16",text:"17",value:"16"},{key:"17",text:"18",value:"17"},{key:"18",text:"19",value:"18"},{key:"19",text:"20",value:"19"}],N=[{key:"type",text:"Type",value:"0"},{key:"no-after",text:"Can't be after",value:"no-after"},{key:"no-before",text:"Can't be before",value:"no-before"},{key:"only-after",text:"Must be after",value:"only-after"},{key:"only-before",text:"Must be before",value:"only-before"},{key:"no-at",text:"Can't be at spot",value:"no-at"},{key:"prefers-at",text:"Must be at spot",value:"prefers-at"}],C=["blue","green","orange","red"];function A(e){let{wave:t,mode:a=0}=e;return s.createElement("div",{className:"scroll timeline"},s.createElement("div",{className:"canvas"},s.createElement("div",{className:"line"}),t.map(((e,t)=>s.createElement("span",{key:`wave${t}`},s.createElement("span",null,s.createElement("div",{className:"slot",key:`t-${t}`,"data-tip":"Info about the genk dslkfjlsdkj <br> sfdldkj sdflkjfd sdlkdfj fskdshfez azoelk.","data-for":"calendar"},s.createElement("div",{className:"card-t"},s.createElement("card-t",{cid:e.cid,backtext:"",backcolor:C[a]})))))))))}A.propTypes={wave:l().array,mode:l().number,noir:l().bool};const G=e=>{let{title:t,onChange:a,id:n,width:i}=e;return s.createElement("label",{className:"switch-label",onClick:()=>a(n),style:{width:i}},t.split(/\s+/).map((e=>e[0].toUpperCase()+e.slice(1))).join(" "))};G.propTypes={title:l().string,onChange:l().func,id:l().number};const T=e=>{let{checked:t}=e;return s.createElement("input",{className:"switch-radio",type:"radio",name:"switch",checked:t,readOnly:!0})};T.propTypes={checked:l().bool};class S extends s.Component{state={selected:this.props.selected};handleChange=e=>{this.setState({selected:e}),this.props.handleSelect(e)};selectionStyle=()=>({left:this.state.selected/this.props.values.length*100+"%",width:100/this.props.values.length+"%"});render(){const{selected:e}=this.state;return s.createElement("div",{className:"switch"},this.props.values.map(((t,a)=>s.createElement("span",{className:"switch-container",key:t},s.createElement(T,{checked:e===a}),s.createElement(G,{title:t,onChange:this.handleChange,id:a,width:100/this.props.values.length+"%"})))),s.createElement("span",{className:"switch-selection",style:this.selectionStyle()}))}}S.propTypes={values:l().array,selected:l().number,handleSelect:l().func},S.defaultProps={values:["days","weeks","months"],selected:0};var D=a(7145),W=a.n(D);const $=e=>{let{mode:t}=e,a=null;return a=0===t?s.createElement("p",null,"At each position, we pick a card from a full 52-cards deck."):1===t?s.createElement("p",null,"At each position, we pick a card from a deck and we take out the card from the deck."):2===t?s.createElement("p",null,"At each position, we pick a card from a weighted deck we define.",s.createElement("br",null)," A card with weight 10 will have 10 times more chances to be picked than a card with weight 1."):s.createElement("p",null,"We apply a constraint-based algorithm (Wave Function Collapse) to distribute our cards.",s.createElement("br",null),"You can define the constraints below."),s.createElement("div",{className:"app-header"},a)};$.propTypes={mode:l().number};class _ extends s.Component{constructor(e){super(e),this.state={wave:new Array(p).fill(g),constraints:[[!0,"0","h","no-after","0","s","0"],[!0,"0","c","no-at","0","s","1"],[!0,"0","s","no-at","0","s","1"],[!0,"Q","d","prefers-at","0","s","0"],[!0,"1","s","no-after","1","0","0"]],weights:[[!0,"1","s",20],[!0,"5","d",5]],mode:0,configHasChanged:!0},this.N=p,this.data=w,this.gen=this.gen.bind(this),this.init=this.init.bind(this),this.reset=this.reset.bind(this),this.onConfigChange=this.onConfigChange.bind(this),this.onModeSelect=this.onModeSelect.bind(this),this.addConstraint=this.addConstraint.bind(this),this.removeConstraint=this.removeConstraint.bind(this),this.updateConstraint=this.updateConstraint.bind(this)}componentDidMount(){a.e(4219).then(a.t.bind(a,4219,23)),this.init()}gen(){const{mode:e,configHasChanged:t}=this.state;let a=null;0===e?(this.fullDeckGenerator.run(),a=this.fullDeckGenerator.getTimeline()):1===e?(this.normalDeckGenerator.reset(),this.normalDeckGenerator.run(),a=this.normalDeckGenerator.getTimeline()):2===e?(t&&(this.weightedDeckGenerator.resetWeights(),this.convertWeights()),this.weightedDeckGenerator.reset(),this.weightedDeckGenerator.run(),a=this.weightedDeckGenerator.getTimeline()):3===e&&(t?(this.wfcGenerator.resetWeights(),this.wfcGenerator.resetConstraints(),this.convertConstraints(),this.wfcGenerator.reset(),this.wfcGenerator.run(),a=this.wfcGenerator.getTimeline()):(this.wfcGenerator.reset(),this.wfcGenerator.run(),a=this.wfcGenerator.getTimeline())),this.setState({wave:a,configHasChanged:!1})}reset(){this.wfcGenerator.reset(),this.normalDeckGenerator.reset(),this.weightedDeckGenerator.reset(),this.setState({wave:new Array(this.N).fill(g)})}init(){this.wfcGenerator=new h(this.N,this.data),this.wfcGenerator.init(),this.fullDeckGenerator=new d(this.N,this.data),this.normalDeckGenerator=new m(this.N,this.data),this.weightedDeckGenerator=new u(this.N,this.data)}onConfigChange(e){this.N!==e.N?(this.N=e.N,this.setState({constraints:e.constraints,configHasChanged:!0},(()=>this.init()))):this.setState({constraints:e.constraints,configHasChanged:!0})}onModeSelect(e){this.setState({mode:e})}addWeight(){this.setState((e=>({weights:[...e.weights,[!1,"0","0",1]],configHasChanged:!0})))}removeWeight(e){this.setState({weights:W()(this.state.weights,{$splice:[[e,1]]}),configHasChanged:!0})}updateWeight(e,t,a){this.setState({weights:W()(this.state.weights,{[e]:{[t]:{$set:a}}}),configHasChanged:!0})}convertWeights(){const{weights:e}=this.state;for(let t=0;t<e.length;t++){const a=e[t];if(a[0])if("0"!==a[1]||"0"!==a[2])if("0"===a[1]&&"0"!==a[2])for(let e=0;e<this.data.length;e++)this.data[e].cid.charAt(1)===a[2]&&this.weightedDeckGenerator.applyWeight(this.data[e].id,a[3]);else if("0"!==a[1]&&"0"===a[2])for(let e=0;e<this.data.length;e++)this.data[e].cid.charAt(0)===a[1]&&this.weightedDeckGenerator.applyWeight(this.data[e].id,a[3]);else for(let e=0;e<this.data.length;e++)this.data[e].cid===`${a[1]}${a[2]}`&&this.weightedDeckGenerator.applyWeight(this.data[e].id,a[3]);else this.updateWeight(t,0,!1)}}addConstraint(){this.setState((e=>({constraints:[...e.constraints,[!1,"0","0","0","0","0"]],configHasChanged:!0})))}removeConstraint(e){this.setState({constraints:W()(this.state.constraints,{$splice:[[e,1]]}),configHasChanged:!0})}updateConstraint(e,t,a){this.setState({constraints:W()(this.state.constraints,{[e]:{[t]:{$set:a}}}),configHasChanged:!0})}convertConstraints(){const{constraints:e}=this.state;for(let t=0;t<e.length;t++){const a=e[t];if(!a[0])continue;let n=[],s=[],i=0,r=0,l=!1;switch(a[3]){case"no-after":i=0;break;case"no-before":i=1;break;case"only-after":l=!0,i=0;break;case"only-before":l=!0,i=1;break;case"no-at":i=2,r=0;break;case"prefers-at":i=2,r=1e4;break;default:this.updateConstraint(t,0,!1);continue}if(l){if("0"===a[1]&&"0"===a[2]){this.updateConstraint(t,0,!1);continue}if("0"===a[1]&&"0"!==a[2]){const e=c().filter(this.data,(e=>e.cid.charAt(1)!==a[2]));for(let t=0;t<e.length;t++)n.push(e[t].id)}else if("0"!==a[1]&&"0"===a[2]){const e=c().filter(this.data,(e=>e.cid.charAt(0)!==a[1]));for(let t=0;t<e.length;t++)n.push(e[t].id)}else{const e=c().filter(this.data,(e=>e.cid===`${a[1]}${a[2]}`));for(let t=0;t<e.length;t++)n.push(e[t].id)}}else{if("0"===a[1]&&"0"===a[2]){this.updateConstraint(t,0,!1);continue}if("0"===a[1]&&"0"!==a[2]){const e=c().filter(this.data,(e=>e.cid.charAt(1)===a[2]));for(let t=0;t<e.length;t++)n.push(e[t].id)}else if("0"!==a[1]&&"0"===a[2]){const e=c().filter(this.data,(e=>e.cid.charAt(0)===a[1]));for(let t=0;t<e.length;t++)n.push(e[t].id)}else{const e=c().findIndex(this.data,(e=>e.cid===`${a[1]}${a[2]}`));n.push(this.data[e].id)}}if(i<2){if("0"===a[4]&&"0"===a[5]){this.updateConstraint(t,0,!1);continue}if("0"===a[4]&&"0"!==a[5]){const e=c().filter(this.data,(e=>e.cid.charAt(1)===a[5]));for(let t=0;t<e.length;t++)s.push(e[t].id)}else if("0"!==a[4]&&"0"===a[5]){const e=c().filter(this.data,(e=>e.cid.charAt(0)===a[4]));for(let t=0;t<e.length;t++)s.push(e[t].id)}else{const e=c().findIndex(this.data,(e=>e.cid===`${a[4]}${a[5]}`));s.push(this.data[e].id)}}else s.push(parseInt(a[6]));i<2?this.wfcGenerator.applyConstraint(n,i,s):this.wfcGenerator.applyWeight(n,s,r)}}render(){const{wave:e,configHasChanged:t,mode:a,constraints:n,weights:i}=this.state;return s.createElement(s.Fragment,null,s.createElement("div",{className:"app-container"},s.createElement(S,{values:["Many full decks","One deck distributed","Weighted decks","Constrained decks"],selected:a,handleSelect:this.onModeSelect}),s.createElement($,{mode:a}),s.createElement(A,{wave:e,mode:a}),s.createElement("div",{className:"buttons"},s.createElement("button",{className:"reset run",onClick:this.reset},s.createElement("span",null,"RESET")),s.createElement("button",{className:"run",onClick:this.gen},s.createElement("span",null,"GEN"),t&&2===a?s.createElement("span",{className:"warn"},"!"):s.createElement(s.Fragment,null))),s.createElement("div",{className:"constraints-container",hidden:2!==a},s.createElement("h3",null,"Weights definition"),s.createElement("div",{className:"constraints"},s.createElement("div",{className:"constraints-line firstLine"},s.createElement("div",{className:"number"},"#"),s.createElement("div",{className:"use"},"Use"),s.createElement("div",{className:"selector"},"Selector"),s.createElement("div",{className:"weight"},"Weight")),i.map(((e,t)=>s.createElement("div",{className:"constraints-line midLine",key:`w-key-${t}`},s.createElement("div",{className:"number"},"#",t+1),s.createElement("div",{className:"use"},s.createElement("input",{type:"checkbox",checked:e[0],onChange:e=>this.updateWeight(t,0,e.target.checked)})),s.createElement("div",{className:"selector"},s.createElement("select",{className:"select-text",value:e[1],onChange:e=>this.updateWeight(t,1,e.target.value)},b.map((e=>s.createElement("option",{key:`w-${e.key}`,value:e.value},e.text)))),s.createElement("select",{value:e[2],onChange:e=>this.updateWeight(t,2,e.target.value),style:{color:"h"===e[2]||"d"===e[2]?"red":"inherit"}},E.map(((e,a)=>s.createElement("option",{key:`w-${e.key}-${t}-${a}`,value:e.value,style:{color:e.color}},e.text))))),s.createElement("div",{className:"weight"},s.createElement("input",{type:"number",min:"0",value:e[3],onChange:e=>this.updateWeight(t,3,e.target.valueAsNumber)})),s.createElement("div",{className:"remove"},s.createElement("button",{style:{borderRadius:"200px",padding:0,paddingBottom:"2px",width:"28px"},onClick:()=>this.removeWeight(t)},"-"))))),s.createElement("div",{className:"constraints-line lastLine"},s.createElement("button",{onClick:()=>this.addWeight()},"Add constraint")))),s.createElement("div",{className:"constraints-container",hidden:3!==a},s.createElement("h3",null,"Constraints definition"),s.createElement("div",{className:"constraints"},s.createElement("div",{className:"constraints-line firstLine"},s.createElement("div",{className:"number"},"#"),s.createElement("div",{className:"use"},"Use"),s.createElement("div",{className:"selector"},"Selector"),s.createElement("div",{className:"type"},"Constraint type"),s.createElement("div",{className:"selector"},"Selector"),s.createElement("div",{className:"remove"},"Suppr.")),n.map(((e,t)=>s.createElement("div",{className:"constraints-line midLine",key:`key-${t}`},s.createElement("div",{className:"number"},"#",t+1),s.createElement("div",{className:"use"},s.createElement("input",{type:"checkbox",checked:e[0],onChange:e=>this.updateConstraint(t,0,e.target.checked)})),s.createElement("div",{className:"selector"},s.createElement("select",{className:"select-text",value:e[1],onChange:e=>this.updateConstraint(t,1,e.target.value)},b.map(((e,a)=>s.createElement("option",{key:`${e.key}-${t}-${a}`,value:e.value},e.text)))),s.createElement("select",{value:e[2],onChange:e=>this.updateConstraint(t,2,e.target.value),style:{color:"h"===e[2]||"d"===e[2]?"red":"inherit"}},E.map(((e,a)=>s.createElement("option",{key:`${e.key}-${t}-${a}`,value:e.value,style:{color:e.color}},e.text))))),s.createElement("div",{className:"type"},s.createElement("select",{value:e[3],onChange:e=>this.updateConstraint(t,3,e.target.value)},N.map((e=>s.createElement("option",{key:e.key,value:e.value},e.text))))),"no-at"!==e[3]&&"prefers-at"!==e[3]?s.createElement("div",{className:"selector"},s.createElement("select",{className:"select-text",value:e[4],onChange:e=>this.updateConstraint(t,4,e.target.value)},b.map(((e,a)=>s.createElement("option",{key:`2-${e.key}-${t}-${a}`,value:e.value},e.text)))),s.createElement("select",{value:e[5],onChange:e=>this.updateConstraint(t,5,e.target.value),style:{color:"h"===e[5]||"d"===e[5]?"red":"inherit"}},E.map(((e,a)=>s.createElement("option",{key:`2-${e.key}-${t}-${a}`,value:e.value,style:{color:e.color}},e.text))))):s.createElement("div",{className:"selector"},s.createElement("select",{value:e[6],onChange:e=>this.updateConstraint(t,6,e.target.value)},x.map((e=>s.createElement("option",{key:e.key,value:e.value},e.text))))),s.createElement("div",{className:"remove"},s.createElement("button",{style:{borderRadius:"200px",padding:0,paddingBottom:"2px",width:"28px"},onClick:()=>this.removeConstraint(t)},"-"))))),s.createElement("div",{className:"constraints-line lastLine"},s.createElement("button",{onClick:()=>this.addConstraint()},"Add constraint"))))))}}const I=_;var M=a(7993),L=a(8313);const H={slug:"content-distribution",title:"Designing randomness: when generation is distribution",draft:!1,tags:["designing randomness","procedural","game design","tools"]},B=void 0,U={permalink:"/blog/content-distribution",source:"@site/blog/2021-07-01-content-distribution.md",title:"Designing randomness: when generation is distribution",description:"Let's distribute cards. But better.",date:"2021-07-01T00:00:00.000Z",formattedDate:"July 1, 2021",tags:[{label:"designing randomness",permalink:"/blog/tags/designing-randomness"},{label:"procedural",permalink:"/blog/tags/procedural"},{label:"game design",permalink:"/blog/tags/game-design"},{label:"tools",permalink:"/blog/tags/tools"}],readingTime:3.81,hasTruncateMarker:!0,authors:[],frontMatter:{slug:"content-distribution",title:"Designing randomness: when generation is distribution",draft:!1,tags:["designing randomness","procedural","game design","tools"]},prevItem:{title:"The quintillions of different runs in Hades (and why it doesn't matter)",permalink:"/blog/arrangements-hell-hades"},nextItem:{title:"Designing information: why is it hard to communicate science",permalink:"/blog/science-popularization"}},j={authorsImageUrls:[]},O=[],Z={toc:O},F="wrapper";function R(e){let{components:t,...a}=e;return(0,i.kt)(F,(0,n.Z)({},Z,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Let's distribute cards. But better."),(0,i.kt)("hr",null),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"Procedural generation"))," is a term probably overused in videogame production. It's so trendy, it makes your system sound so smart where you often just call ",(0,i.kt)("inlineCode",{parentName:"p"},"random()")," a bunch of times."),(0,i.kt)(M.Z,{srcImage:"img/illustrations/wiki-procedural.png",altText:"wiki-procedural",legend:"Randomly generated redirects here. Oof.",mdxType:"Image"}),(0,i.kt)("p",null,"I personally see ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"procedural generation"))," as a glorified name to designate ",(0,i.kt)("strong",{parentName:"p"},"a function with a small input that spits out a big output"),". And for me, this is the whole point: from a minimal set of handcrafted parameters, get the maximal results you can thanks to a ",(0,i.kt)("em",{parentName:"p"},"procedure"),", an ",(0,i.kt)("em",{parentName:"p"},"algorithm"),", a ",(0,i.kt)("em",{parentName:"p"},"piece of code"),", ... to avoid doing everything yourself."),(0,i.kt)("p",null,"If ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"procedural generation"))," is already ubiquitous in the art pipelines of most videogame/VFX/animation studio, it has also lived in the realm of game design for a long time."),(0,i.kt)("p",null,"In this ",(0,i.kt)("a",{parentName:"p",href:"/blog/tags/designing-randomness"},"series of short articles")," called ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"Designing randomness")),", I dive into the field of ",(0,i.kt)("strong",{parentName:"p"},"procedural game design"),"."),(0,i.kt)("hr",null),(0,i.kt)("p",null,"In game design, ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"procedural generation"))," is often focused on ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"generating game content"))," : making an infinite amount of dungeons for the player to explore in a roguelike is the quintessential example, so let's take it."),(0,i.kt)("p",null,"Dungeons in roguelikes are not generated through some kind of superpowerful algorithm, redrawing every position of every brick to create a new yet coherent piece of architecture. The problem is much simpler, and it starts with defining a dungeon from a level design perspective:"),(0,i.kt)("p",{style:{textAlign:"center",fontWeight:"bold",marginTop:"20px",fontSize:"18px"}},"99,9% of the time, a dungeon is an assemblage of pre-made rooms."),(0,i.kt)("p",null,"Generating a dungeon then becomes choosing rooms from an existing library and linking rooms with doors. Much better!"),(0,i.kt)("br",null),(0,i.kt)(L.Z,{srcUrl:"https://www.youtube.com/embed/1-HIA6-LBJc",legend:"The original programmer of Binding of Isaac on the Room Generation algorithm he conceived for the game",mdxType:"Iframe"}),(0,i.kt)("br",null),(0,i.kt)("p",null,"This subspace of procedural generation, ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"distributing pre-existing content")),", is well adapted to most designers' needs. Thus, design tasks are split in two layers: ",(0,i.kt)("strong",{parentName:"p"},"designing individuals rooms")," to serve the second to second gameplay, ",(0,i.kt)("strong",{parentName:"p"},"designing the rules of assemblage")," to serve the minute to minute exploration of our dungeon."),(0,i.kt)("p",null,"This second layer is where procedural game design takes center stage: the ",(0,i.kt)("strong",{parentName:"p"},"use of randomness is essential")," to keep the world fresh and unpredictible for players, but we still need ",(0,i.kt)("strong",{parentName:"p"},"a level of control on the assemblage algorithm to inject level design rules")," (for pacing, logic, avoiding repetition). Easier said than done! Striking a design balance between the predictability of rules and the impredictability of their random use is key to generate endless amounts of enjoyable dungeons."),(0,i.kt)("br",null),(0,i.kt)(L.Z,{srcUrl:"https://www.youtube.com/embed/ClZe5x8Tfiw",legend:"Hades world structure uses this exact principle: a series of rooms that you cross one after the other!",mdxType:"Iframe"}),(0,i.kt)("br",null),(0,i.kt)("hr",null),(0,i.kt)("p",null,"Let's simplify the problem a bit more: ",(0,i.kt)("strong",{parentName:"p"},"let's say our dungeon is a straight corridor of 20 rooms back to back"),". Our brave designer created a library of 52 rooms that can be represented by the usual poker cards. I like the card representation because I think it mimics well ",(0,i.kt)("em",{parentName:"p"},"the reality of content development"),": you have ",(0,i.kt)("strong",{parentName:"p"},"many ways to subdivide a given set"),". In the case of cards: ",(0,i.kt)("strong",{parentName:"p"},"suit, color, value, figures"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"This next interactive toy lets you play with 4 different ways to distribute 20 ordered cards"),", 4 different ways to build a dungeon, from dumb to smart, from dead simple to not-so-simple."),(0,i.kt)("p",null,"With the last one, I tried to strike the balance between random and rules I talked earlier by using a ",(0,i.kt)("strong",{parentName:"p"},"constraint based algorithm (the popular Wave Function Collapse): it's often simpler to say to the computer what you don't want and then let it generate something that respects that"),"."),(0,i.kt)("p",null,"It's obviously applied on a very simple problem, but it will hopefully help you grasp what is at stake when we want to distribute content in a ",(0,i.kt)("em",{parentName:"p"},"design-sensitive")," way."),(0,i.kt)(I,{mdxType:"ContentDistribution"}),(0,i.kt)("br",null))}R.isMDXComponent=!0}}]);