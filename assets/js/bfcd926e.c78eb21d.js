"use strict";(self.webpackChunkjb_blog=self.webpackChunkjb_blog||[]).push([[3020],{1215:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>U,contentTitle:()=>H,default:()=>F,frontMatter:()=>E,metadata:()=>B,toc:()=>O});var i=s(4848),n=s(8453),a=s(6540),r=s(5556),o=s.n(r),l=s(2543),h=s.n(l);class c{constructor(e,t){this.n=e,this.timeline=new Array(e),this.entropies=new Array(e),this.tiles=new Array(t.length),this.n_tiles=t.length;for(let s=0;s<t.length;s++){const i=t[s];this.tiles[s]={id:i.id,cid:i.cid,label:i.label,color:i.color,weights:new Array(e).fill(1)}}this.wave=new Array(e),this.wavefront=new Array(e).fill(!1),this.wave_save=new Array(e),this.constraints_propagator=[new Array(this.n_tiles).fill(new Array(this.n_tiles).fill(!0)),new Array(this.n_tiles).fill(new Array(this.n_tiles).fill(!0))],this.preferences_propagator=[],this.ready=!1,this.DEBUG_LOGS=!1}init(){this.setupWave()}getWave(){return this.wave}getTimeline(){return this.timeline}reset(){this.setupWave(),this.timeline=new Array(this.n)}resetConstraints(){this.constraints_propagator=[new Array(this.n_tiles).fill(new Array(this.n_tiles).fill(!0)),new Array(this.n_tiles).fill(new Array(this.n_tiles).fill(!0))]}setupWave(){this.wave=new Array(this.n),this.wavefront=new Array(this.n).fill(!1);for(let e=0;e<this.n;e++){this.wave[e]=[];for(let t=0;t<this.tiles.length;t++)this.tiles[t].weights[e]>0&&this.wave[e].push({id:this.tiles[t].id,cid:this.tiles[t].cid,label:this.tiles[t].label,color:this.tiles[t].color,weights:this.tiles[t].weights[e],distribution:0})}}setupPropagators(){this.constraints_propagator=[new Array(this.n_tiles).fill(new Array(this.n_tiles).fill(!0)),new Array(this.n_tiles).fill(new Array(this.n_tiles).fill(!0))]}applyConstraint(e,t,s){for(let i=0;i<e.length;i++)for(let n=0;n<s.length;n++)this.addConstraint(e[i],t,s[n])}addConstraint(e,t,s){this.constraints_propagator[t][e][s]=!1,this.constraints_propagator[(t+1)%2][s][e]=!1}resetWeights(){for(let e=0;e<this.tiles.length;e++)this.tiles[e].weights=new Array(this.n).fill(1)}applyWeight(e,t,s){for(let i=0;i<e.length;i++)this.tiles[e[i]].weights[t[0]]=s}computeEntropy(){for(let e=0;e<this.n;e++){if(this.wavefront[e]){this.entropies[e]=1e8;continue}const t=this.wave[e];let s=0;for(let e=0;e<t.length;e++)s+=t[e].weights;let i=0;for(let e=0;e<t.length;e++){const n=t[e].weights/s;t[e].distribution=n,0!==n&&(i-=n*Math.log(n))}this.entropies[e]=h().round(i,5)}}observe(){let e=Number.MAX_VALUE,t=-1,s=[];for(let i=0;i<this.n;i++){if(this.wavefront[i])continue;const n=this.entropies[i];n<e?(e=n,t=0,s=[i]):n===e&&s.push(i)}if(-1===t)throw console.error("ENTROPIES WRONGLY COMPUTED");return s[h().random(s.length-1)]}isDone(){let e=!0;for(let t=0;t<this.n;t++)if(!this.wavefront[t]){e=!1;break}return e}propagate(e,t){this.timeline[e]=this.wave[e][t];const s=this.wave[e][t].id;this.wave[e]=this.wave[e][t],this.wavefront[e]=!0;let i=0;if(e>0&&!1===this.wavefront[e-1]){const t=this.constraints_propagator[0][s];h().remove(this.wave[e-1],(function(e){return!t[e.id]&&(i+=1,!0)}))}if(e<this.n-1&&!1===this.wavefront[e+1]){const t=this.constraints_propagator[1][s];h().remove(this.wave[e+1],(function(e){return!t[e.id]&&(i+=1,!0)}))}return i}step(){this.computeEntropy();const e=this.observe(),t=function(e){let t=0,s=Math.random();for(;s>0;)s-=e[t].distribution,t++;return t--,t}(this.wave[e]),s=this.propagate(e,t);this.DEBUG_LOGS&&console.log(`The tile ${t} was placed at the spot ${e}, ${s} elements were removed from a potential spot during propagation`)}run(){for(;!this.isDone();)this.step()}slowRun(e){for(;!this.isDone();)setTimeout(this.step(),e)}}class d{constructor(e,t){this.n=e,this.timeline=new Array(e),this.deck=[...t],this.DEBUG_LOGS=!1}getTimeline(){return this.timeline}run(){for(let e=0;e<this.n;e++){const t=h().random(this.deck.length-1);this.timeline[e]=this.deck[t]}}}class u{constructor(e,t){this.n=e,this.timeline=new Array(e),this.deck=[...t],this.deck_save=[...t],this.DEBUG_LOGS=!1}reset(){this.deck=[...this.deck_save]}getTimeline(){return this.timeline}run(){for(let e=0;e<this.n;e++){const t=h().random(this.deck.length-1);this.timeline[e]=this.deck[t],h().pullAt(this.deck,[t])}}}class g{constructor(e,t){this.n=e,this.timeline=new Array(e),this.tiles=new Array(t.length);for(let s=0;s<t.length;s++){const e=t[s];this.tiles[s]={id:e.id,cid:e.cid,weight:1}}this.deck=[...t],this.DEBUG_LOGS=!1}reset(){this.timeline=new Array(this.n)}resetWeights(){for(let e=0;e<this.tiles.length;e++)this.tiles[e].weight=1}applyWeight(e,t){this.tiles[e].weight=t}resetWeight(e){this.tiles[e].weight=1}getTimeline(){return this.timeline}run(){let e=0;for(let t=0;t<this.tiles.length;t++)e+=this.tiles[t].weight;console.log(this.tiles),console.log(e);for(let t=0;t<this.n;t++){const s=h().random(e);let i=0;for(let e=0;e<this.tiles.length;e++)if(i+=this.tiles[e].weight,i>s){this.timeline[t]=this.tiles[e];break}}}}const p=20,m={cid:"00",label:"",color:"#fff"},f=["s","h","d","c"],x=["Spades","Hearts","Diamonds","Clubs"];function v(e,t){let s="";return s=11===t?"Jack of ":12===t?"Queen of ":13===t?"King of ":`${t} of `,s+=x[e],s}function y(e,t){let s="";return s=11===t?"J":12===t?"Q":13===t?"K":`${t}`,s+=f[e],s}const w=[];for(let P=0;P<4;P++)for(let e=1;e<14;e++)w.push({id:13*P+e-1,cid:y(P,e),label:v(P,e),color:"#868686"});new Array(p).fill(1),new Array(p).fill(1),new Array(p).fill(1),new Array(p).fill(1),new Array(p).fill(1),new Array(p).fill(1),new Array(p).fill(1);const j=[{key:"any",text:"Any",value:"0"},{key:"ace",text:"Ace",value:"1"},{key:"2",text:"2",value:"2"},{key:"3",text:"3",value:"3"},{key:"4",text:"4",value:"4"},{key:"5",text:"5",value:"5"},{key:"6",text:"6",value:"6"},{key:"7",text:"7",value:"7"},{key:"8",text:"8",value:"8"},{key:"9",text:"9",value:"9"},{key:"10",text:"10",value:"10"},{key:"jack",text:"Jack",value:"J"},{key:"queen",text:"Queen",value:"Q"},{key:"king",text:"King",value:"K"}],k=[{key:"0",text:"Suit",value:"0",color:"#495057"},{key:"s",text:"\u2660\ufe0f",value:"s",color:"black"},{key:"h",text:"\u2665\ufe0f",value:"h",color:"red"},{key:"h",text:"\u2666\ufe0f",value:"d",color:"red"},{key:"c",text:"\u2663\ufe0f",value:"c",color:"black"}],b=[{key:"0",text:"1",value:"0"},{key:"1",text:"2",value:"1"},{key:"2",text:"3",value:"2"},{key:"3",text:"4",value:"3"},{key:"4",text:"5",value:"4"},{key:"5",text:"6",value:"5"},{key:"6",text:"7",value:"6"},{key:"7",text:"8",value:"7"},{key:"8",text:"9",value:"8"},{key:"9",text:"10",value:"9"},{key:"10",text:"11",value:"10"},{key:"11",text:"12",value:"11"},{key:"12",text:"13",value:"12"},{key:"13",text:"14",value:"13"},{key:"14",text:"15",value:"14"},{key:"15",text:"16",value:"15"},{key:"16",text:"17",value:"16"},{key:"17",text:"18",value:"17"},{key:"18",text:"19",value:"18"},{key:"19",text:"20",value:"19"}],C=[{key:"type",text:"Type",value:"0"},{key:"no-after",text:"Can't be after",value:"no-after"},{key:"no-before",text:"Can't be before",value:"no-before"},{key:"only-after",text:"Must be after",value:"only-after"},{key:"only-before",text:"Must be before",value:"only-before"},{key:"no-at",text:"Can't be at spot",value:"no-at"},{key:"prefers-at",text:"Must be at spot",value:"prefers-at"}],A=["blue","green","orange","red"];function N(e){let{wave:t,mode:s=0}=e;return(0,i.jsx)("div",{className:"scroll timeline",children:(0,i.jsxs)("div",{className:"canvas",children:[(0,i.jsx)("div",{className:"line"}),t.map(((e,t)=>(0,i.jsx)("span",{children:(0,i.jsx)("span",{children:(0,i.jsx)("div",{className:"slot","data-tip":"Info about the genk dslkfjlsdkj <br> sfdldkj sdflkjfd sdlkdfj fskdshfez azoelk.","data-for":"calendar",children:(0,i.jsx)("div",{className:"card-t",children:(0,i.jsx)("card-t",{cid:e.cid,backtext:"",backcolor:A[s]})})},`t-${t}`)})},`wave${t}`)))]})})}N.propTypes={wave:o().array,mode:o().number,noir:o().bool};const G=e=>{let{title:t,onChange:s,id:n,width:a}=e;return(0,i.jsx)("label",{className:"switch-label",onClick:()=>s(n),style:{width:a},children:(r=t,r.split(/\s+/).map((e=>e[0].toUpperCase()+e.slice(1))).join(" "))});var r};G.propTypes={title:o().string,onChange:o().func,id:o().number};const S=e=>{let{checked:t}=e;return(0,i.jsx)("input",{className:"switch-radio",type:"radio",name:"switch",checked:t,readOnly:!0})};S.propTypes={checked:o().bool};class T extends a.Component{state={selected:this.props.selected};handleChange=e=>{this.setState({selected:e}),this.props.handleSelect(e)};selectionStyle=()=>({left:this.state.selected/this.props.values.length*100+"%",width:100/this.props.values.length+"%"});render(){const{selected:e}=this.state;return(0,i.jsxs)("div",{className:"switch",children:[this.props.values.map(((t,s)=>(0,i.jsxs)("span",{className:"switch-container",children:[(0,i.jsx)(S,{checked:e===s}),(0,i.jsx)(G,{title:t,onChange:this.handleChange,id:s,width:100/this.props.values.length+"%"})]},t))),(0,i.jsx)("span",{className:"switch-selection",style:this.selectionStyle()})]})}}T.propTypes={values:o().array,selected:o().number,handleSelect:o().func},T.defaultProps={values:["days","weeks","months"],selected:0};var W=s(6894),$=s.n(W);const D=e=>{let{mode:t}=e,s=null;return s=0===t?(0,i.jsx)("p",{children:"At each position, we pick a card from a full 52-cards deck."}):1===t?(0,i.jsx)("p",{children:"At each position, we pick a card from a deck and we take out the card from the deck."}):2===t?(0,i.jsxs)("p",{children:["At each position, we pick a card from a weighted deck we define.",(0,i.jsx)("br",{})," A card with weight 10 will have 10 times more chances to be picked than a card with weight 1."]}):(0,i.jsxs)("p",{children:["We apply a constraint-based algorithm (Wave Function Collapse) to distribute our cards.",(0,i.jsx)("br",{}),"You can define the constraints below."]}),(0,i.jsx)("div",{className:"app-header",children:s})};D.propTypes={mode:o().number};class _ extends a.Component{constructor(e){super(e),this.state={wave:new Array(p).fill(m),constraints:[[!0,"0","h","no-after","0","s","0"],[!0,"0","c","no-at","0","s","1"],[!0,"0","s","no-at","0","s","1"],[!0,"Q","d","prefers-at","0","s","0"],[!0,"1","s","no-after","1","0","0"]],weights:[[!0,"1","s",20],[!0,"5","d",5]],mode:0,configHasChanged:!0},this.N=p,this.data=w,this.gen=this.gen.bind(this),this.init=this.init.bind(this),this.reset=this.reset.bind(this),this.onConfigChange=this.onConfigChange.bind(this),this.onModeSelect=this.onModeSelect.bind(this),this.addConstraint=this.addConstraint.bind(this),this.removeConstraint=this.removeConstraint.bind(this),this.updateConstraint=this.updateConstraint.bind(this)}componentDidMount(){s.e(6863).then(s.t.bind(s,6863,23)),this.init()}gen(){const{mode:e,configHasChanged:t}=this.state;let s=null;0===e?(this.fullDeckGenerator.run(),s=this.fullDeckGenerator.getTimeline()):1===e?(this.normalDeckGenerator.reset(),this.normalDeckGenerator.run(),s=this.normalDeckGenerator.getTimeline()):2===e?(t&&(this.weightedDeckGenerator.resetWeights(),this.convertWeights()),this.weightedDeckGenerator.reset(),this.weightedDeckGenerator.run(),s=this.weightedDeckGenerator.getTimeline()):3===e&&(t?(this.wfcGenerator.resetWeights(),this.wfcGenerator.resetConstraints(),this.convertConstraints(),this.wfcGenerator.reset(),this.wfcGenerator.run(),s=this.wfcGenerator.getTimeline()):(this.wfcGenerator.reset(),this.wfcGenerator.run(),s=this.wfcGenerator.getTimeline())),this.setState({wave:s,configHasChanged:!1})}reset(){this.wfcGenerator.reset(),this.normalDeckGenerator.reset(),this.weightedDeckGenerator.reset(),this.setState({wave:new Array(this.N).fill(m)})}init(){this.wfcGenerator=new c(this.N,this.data),this.wfcGenerator.init(),this.fullDeckGenerator=new d(this.N,this.data),this.normalDeckGenerator=new u(this.N,this.data),this.weightedDeckGenerator=new g(this.N,this.data)}onConfigChange(e){this.N!==e.N?(this.N=e.N,this.setState({constraints:e.constraints,configHasChanged:!0},(()=>this.init()))):this.setState({constraints:e.constraints,configHasChanged:!0})}onModeSelect(e){this.setState({mode:e})}addWeight(){this.setState((e=>({weights:[...e.weights,[!1,"0","0",1]],configHasChanged:!0})))}removeWeight(e){this.setState({weights:$()(this.state.weights,{$splice:[[e,1]]}),configHasChanged:!0})}updateWeight(e,t,s){this.setState({weights:$()(this.state.weights,{[e]:{[t]:{$set:s}}}),configHasChanged:!0})}convertWeights(){const{weights:e}=this.state;for(let t=0;t<e.length;t++){const s=e[t];if(s[0])if("0"!==s[1]||"0"!==s[2])if("0"===s[1]&&"0"!==s[2])for(let e=0;e<this.data.length;e++)this.data[e].cid.charAt(1)===s[2]&&this.weightedDeckGenerator.applyWeight(this.data[e].id,s[3]);else if("0"!==s[1]&&"0"===s[2])for(let e=0;e<this.data.length;e++)this.data[e].cid.charAt(0)===s[1]&&this.weightedDeckGenerator.applyWeight(this.data[e].id,s[3]);else for(let e=0;e<this.data.length;e++)this.data[e].cid===`${s[1]}${s[2]}`&&this.weightedDeckGenerator.applyWeight(this.data[e].id,s[3]);else this.updateWeight(t,0,!1)}}addConstraint(){this.setState((e=>({constraints:[...e.constraints,[!1,"0","0","0","0","0"]],configHasChanged:!0})))}removeConstraint(e){this.setState({constraints:$()(this.state.constraints,{$splice:[[e,1]]}),configHasChanged:!0})}updateConstraint(e,t,s){this.setState({constraints:$()(this.state.constraints,{[e]:{[t]:{$set:s}}}),configHasChanged:!0})}convertConstraints(){const{constraints:e}=this.state;for(let t=0;t<e.length;t++){const s=e[t];if(!s[0])continue;let i=[],n=[],a=0,r=0,o=!1;switch(s[3]){case"no-after":a=0;break;case"no-before":a=1;break;case"only-after":o=!0,a=0;break;case"only-before":o=!0,a=1;break;case"no-at":a=2,r=0;break;case"prefers-at":a=2,r=1e4;break;default:this.updateConstraint(t,0,!1);continue}if(o){if("0"===s[1]&&"0"===s[2]){this.updateConstraint(t,0,!1);continue}if("0"===s[1]&&"0"!==s[2]){const e=h().filter(this.data,(e=>e.cid.charAt(1)!==s[2]));for(let t=0;t<e.length;t++)i.push(e[t].id)}else if("0"!==s[1]&&"0"===s[2]){const e=h().filter(this.data,(e=>e.cid.charAt(0)!==s[1]));for(let t=0;t<e.length;t++)i.push(e[t].id)}else{const e=h().filter(this.data,(e=>e.cid===`${s[1]}${s[2]}`));for(let t=0;t<e.length;t++)i.push(e[t].id)}}else{if("0"===s[1]&&"0"===s[2]){this.updateConstraint(t,0,!1);continue}if("0"===s[1]&&"0"!==s[2]){const e=h().filter(this.data,(e=>e.cid.charAt(1)===s[2]));for(let t=0;t<e.length;t++)i.push(e[t].id)}else if("0"!==s[1]&&"0"===s[2]){const e=h().filter(this.data,(e=>e.cid.charAt(0)===s[1]));for(let t=0;t<e.length;t++)i.push(e[t].id)}else{const e=h().findIndex(this.data,(e=>e.cid===`${s[1]}${s[2]}`));i.push(this.data[e].id)}}if(a<2){if("0"===s[4]&&"0"===s[5]){this.updateConstraint(t,0,!1);continue}if("0"===s[4]&&"0"!==s[5]){const e=h().filter(this.data,(e=>e.cid.charAt(1)===s[5]));for(let t=0;t<e.length;t++)n.push(e[t].id)}else if("0"!==s[4]&&"0"===s[5]){const e=h().filter(this.data,(e=>e.cid.charAt(0)===s[4]));for(let t=0;t<e.length;t++)n.push(e[t].id)}else{const e=h().findIndex(this.data,(e=>e.cid===`${s[4]}${s[5]}`));n.push(this.data[e].id)}}else n.push(parseInt(s[6]));a<2?this.wfcGenerator.applyConstraint(i,a,n):this.wfcGenerator.applyWeight(i,n,r)}}render(){const{wave:e,configHasChanged:t,mode:s,constraints:n,weights:a}=this.state;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"app-container",children:[(0,i.jsx)(T,{values:["Many full decks","One deck distributed","Weighted decks","Constrained decks"],selected:s,handleSelect:this.onModeSelect}),(0,i.jsx)(D,{mode:s}),(0,i.jsx)(N,{wave:e,mode:s}),(0,i.jsxs)("div",{className:"buttons",children:[(0,i.jsx)("button",{className:"reset run",onClick:this.reset,children:(0,i.jsx)("span",{children:"RESET"})}),(0,i.jsxs)("button",{className:"run",onClick:this.gen,children:[(0,i.jsx)("span",{children:"GEN"}),t&&2===s?(0,i.jsx)("span",{className:"warn",children:"!"}):(0,i.jsx)(i.Fragment,{})]})]}),(0,i.jsxs)("div",{className:"constraints-container",hidden:2!==s,children:[(0,i.jsx)("h3",{children:"Weights definition"}),(0,i.jsxs)("div",{className:"constraints",children:[(0,i.jsxs)("div",{className:"constraints-line firstLine",children:[(0,i.jsx)("div",{className:"number",children:"#"}),(0,i.jsx)("div",{className:"use",children:"Use"}),(0,i.jsx)("div",{className:"selector",children:"Selector"}),(0,i.jsx)("div",{className:"weight",children:"Weight"})]}),a.map(((e,t)=>(0,i.jsxs)("div",{className:"constraints-line midLine",children:[(0,i.jsxs)("div",{className:"number",children:["#",t+1]}),(0,i.jsx)("div",{className:"use",children:(0,i.jsx)("input",{type:"checkbox",checked:e[0],onChange:e=>this.updateWeight(t,0,e.target.checked)})}),(0,i.jsxs)("div",{className:"selector",children:[(0,i.jsx)("select",{className:"select-text",value:e[1],onChange:e=>this.updateWeight(t,1,e.target.value),children:j.map((e=>(0,i.jsx)("option",{value:e.value,children:e.text},`w-${e.key}`)))}),(0,i.jsx)("select",{value:e[2],onChange:e=>this.updateWeight(t,2,e.target.value),style:{color:"h"===e[2]||"d"===e[2]?"red":"inherit"},children:k.map(((e,s)=>(0,i.jsx)("option",{value:e.value,style:{color:e.color},children:e.text},`w-${e.key}-${t}-${s}`)))})]}),(0,i.jsx)("div",{className:"weight",children:(0,i.jsx)("input",{type:"number",min:"0",value:e[3],onChange:e=>this.updateWeight(t,3,e.target.valueAsNumber)})}),(0,i.jsx)("div",{className:"remove",children:(0,i.jsx)("button",{style:{borderRadius:"200px",padding:0,paddingBottom:"2px",width:"28px"},onClick:()=>this.removeWeight(t),children:"-"})})]},`w-key-${t}`))),(0,i.jsx)("div",{className:"constraints-line lastLine",children:(0,i.jsx)("button",{onClick:()=>this.addWeight(),children:"Add constraint"})})]})]}),(0,i.jsxs)("div",{className:"constraints-container",hidden:3!==s,children:[(0,i.jsx)("h3",{children:"Constraints definition"}),(0,i.jsxs)("div",{className:"constraints",children:[(0,i.jsxs)("div",{className:"constraints-line firstLine",children:[(0,i.jsx)("div",{className:"number",children:"#"}),(0,i.jsx)("div",{className:"use",children:"Use"}),(0,i.jsx)("div",{className:"selector",children:"Selector"}),(0,i.jsx)("div",{className:"type",children:"Constraint type"}),(0,i.jsx)("div",{className:"selector",children:"Selector"}),(0,i.jsx)("div",{className:"remove",children:"Suppr."})]}),n.map(((e,t)=>(0,i.jsxs)("div",{className:"constraints-line midLine",children:[(0,i.jsxs)("div",{className:"number",children:["#",t+1]}),(0,i.jsx)("div",{className:"use",children:(0,i.jsx)("input",{type:"checkbox",checked:e[0],onChange:e=>this.updateConstraint(t,0,e.target.checked)})}),(0,i.jsxs)("div",{className:"selector",children:[(0,i.jsx)("select",{className:"select-text",value:e[1],onChange:e=>this.updateConstraint(t,1,e.target.value),children:j.map(((e,s)=>(0,i.jsx)("option",{value:e.value,children:e.text},`${e.key}-${t}-${s}`)))}),(0,i.jsx)("select",{value:e[2],onChange:e=>this.updateConstraint(t,2,e.target.value),style:{color:"h"===e[2]||"d"===e[2]?"red":"inherit"},children:k.map(((e,s)=>(0,i.jsx)("option",{value:e.value,style:{color:e.color},children:e.text},`${e.key}-${t}-${s}`)))})]}),(0,i.jsx)("div",{className:"type",children:(0,i.jsx)("select",{value:e[3],onChange:e=>this.updateConstraint(t,3,e.target.value),children:C.map((e=>(0,i.jsx)("option",{value:e.value,children:e.text},e.key)))})}),"no-at"!==e[3]&&"prefers-at"!==e[3]?(0,i.jsxs)("div",{className:"selector",children:[(0,i.jsx)("select",{className:"select-text",value:e[4],onChange:e=>this.updateConstraint(t,4,e.target.value),children:j.map(((e,s)=>(0,i.jsx)("option",{value:e.value,children:e.text},`2-${e.key}-${t}-${s}`)))}),(0,i.jsx)("select",{value:e[5],onChange:e=>this.updateConstraint(t,5,e.target.value),style:{color:"h"===e[5]||"d"===e[5]?"red":"inherit"},children:k.map(((e,s)=>(0,i.jsx)("option",{value:e.value,style:{color:e.color},children:e.text},`2-${e.key}-${t}-${s}`)))})]}):(0,i.jsx)("div",{className:"selector",children:(0,i.jsx)("select",{value:e[6],onChange:e=>this.updateConstraint(t,6,e.target.value),children:b.map((e=>(0,i.jsx)("option",{value:e.value,children:e.text},e.key)))})}),(0,i.jsx)("div",{className:"remove",children:(0,i.jsx)("button",{style:{borderRadius:"200px",padding:0,paddingBottom:"2px",width:"28px"},onClick:()=>this.removeConstraint(t),children:"-"})})]},`key-${t}`))),(0,i.jsx)("div",{className:"constraints-line lastLine",children:(0,i.jsx)("button",{onClick:()=>this.addConstraint(),children:"Add constraint"})})]})]})]})})}}const I=_;var M=s(2929),L=s(2446);const E={slug:"content-distribution",title:"Designing randomness: when generation is distribution",draft:!1,tags:["designing randomness","procedural","game design","tools"]},H=void 0,B={permalink:"/blog/content-distribution",source:"@site/blog/2021-07-01-content-distribution.md",title:"Designing randomness: when generation is distribution",description:"Let's distribute cards. But better.",date:"2021-07-01T00:00:00.000Z",formattedDate:"July 1, 2021",tags:[{label:"designing randomness",permalink:"/blog/tags/designing-randomness"},{label:"procedural",permalink:"/blog/tags/procedural"},{label:"game design",permalink:"/blog/tags/game-design"},{label:"tools",permalink:"/blog/tags/tools"}],readingTime:3.81,hasTruncateMarker:!0,authors:[],frontMatter:{slug:"content-distribution",title:"Designing randomness: when generation is distribution",draft:!1,tags:["designing randomness","procedural","game design","tools"]},unlisted:!1,prevItem:{title:"The quintillions of different runs in Hades (and why it doesn't matter)",permalink:"/blog/arrangements-hell-hades"},nextItem:{title:"Designing information: why is it hard to communicate science",permalink:"/blog/science-popularization"}},U={authorsImageUrls:[]},O=[];function R(e){const t={a:"a",code:"code",em:"em",hr:"hr",p:"p",strong:"strong",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"Let's distribute cards. But better."}),"\n","\n","\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:"Procedural generation"})})," is a term probably overused in videogame production. It's so trendy, it makes your system sound so smart where you often just call ",(0,i.jsx)(t.code,{children:"random()"})," a bunch of times."]}),"\n",(0,i.jsx)(M.A,{srcImage:"img/illustrations/wiki-procedural.png",altText:"wiki-procedural",legend:"Randomly generated redirects here. Oof."}),"\n",(0,i.jsxs)(t.p,{children:["I personally see ",(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:"procedural generation"})})," as a glorified name to designate ",(0,i.jsx)(t.strong,{children:"a function with a small input that spits out a big output"}),". And for me, this is the whole point: from a minimal set of handcrafted parameters, get the maximal results you can thanks to a ",(0,i.jsx)(t.em,{children:"procedure"}),", an ",(0,i.jsx)(t.em,{children:"algorithm"}),", a ",(0,i.jsx)(t.em,{children:"piece of code"}),", ... to avoid doing everything yourself."]}),"\n",(0,i.jsxs)(t.p,{children:["If ",(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:"procedural generation"})})," is already ubiquitous in the art pipelines of most videogame/VFX/animation studio, it has also lived in the realm of game design for a long time."]}),"\n",(0,i.jsxs)(t.p,{children:["In this ",(0,i.jsx)(t.a,{href:"/blog/tags/designing-randomness",children:"series of short articles"})," called ",(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:"Designing randomness"})}),", I dive into the field of ",(0,i.jsx)(t.strong,{children:"procedural game design"}),"."]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsxs)(t.p,{children:["In game design, ",(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:"procedural generation"})})," is often focused on ",(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:"generating game content"})})," : making an infinite amount of dungeons for the player to explore in a roguelike is the quintessential example, so let's take it."]}),"\n",(0,i.jsx)(t.p,{children:"Dungeons in roguelikes are not generated through some kind of superpowerful algorithm, redrawing every position of every brick to create a new yet coherent piece of architecture. The problem is much simpler, and it starts with defining a dungeon from a level design perspective:"}),"\n",(0,i.jsx)("p",{style:{textAlign:"center",fontWeight:"bold",marginTop:"20px",fontSize:"18px"},children:(0,i.jsx)(t.p,{children:"99,9% of the time, a dungeon is an assemblage of pre-made rooms."})}),"\n",(0,i.jsx)(t.p,{children:"Generating a dungeon then becomes choosing rooms from an existing library and linking rooms with doors. Much better!"}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(L.A,{srcUrl:"https://www.youtube.com/embed/1-HIA6-LBJc",legend:"The original programmer of Binding of Isaac on the Room Generation algorithm he conceived for the game"}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsxs)(t.p,{children:["This subspace of procedural generation, ",(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:"distributing pre-existing content"})}),", is well adapted to most designers' needs. Thus, design tasks are split in two layers: ",(0,i.jsx)(t.strong,{children:"designing individuals rooms"})," to serve the second to second gameplay, ",(0,i.jsx)(t.strong,{children:"designing the rules of assemblage"})," to serve the minute to minute exploration of our dungeon."]}),"\n",(0,i.jsxs)(t.p,{children:["This second layer is where procedural game design takes center stage: the ",(0,i.jsx)(t.strong,{children:"use of randomness is essential"})," to keep the world fresh and unpredictible for players, but we still need ",(0,i.jsx)(t.strong,{children:"a level of control on the assemblage algorithm to inject level design rules"})," (for pacing, logic, avoiding repetition). Easier said than done! Striking a design balance between the predictability of rules and the impredictability of their random use is key to generate endless amounts of enjoyable dungeons."]}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(L.A,{srcUrl:"https://www.youtube.com/embed/ClZe5x8Tfiw",legend:"Hades world structure uses this exact principle: a series of rooms that you cross one after the other!"}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsxs)(t.p,{children:["Let's simplify the problem a bit more: ",(0,i.jsx)(t.strong,{children:"let's say our dungeon is a straight corridor of 20 rooms back to back"}),". Our brave designer created a library of 52 rooms that can be represented by the usual poker cards. I like the card representation because I think it mimics well ",(0,i.jsx)(t.em,{children:"the reality of content development"}),": you have ",(0,i.jsx)(t.strong,{children:"many ways to subdivide a given set"}),". In the case of cards: ",(0,i.jsx)(t.strong,{children:"suit, color, value, figures"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"This next interactive toy lets you play with 4 different ways to distribute 20 ordered cards"}),", 4 different ways to build a dungeon, from dumb to smart, from dead simple to not-so-simple."]}),"\n",(0,i.jsxs)(t.p,{children:["With the last one, I tried to strike the balance between random and rules I talked earlier by using a ",(0,i.jsx)(t.strong,{children:"constraint based algorithm (the popular Wave Function Collapse): it's often simpler to say to the computer what you don't want and then let it generate something that respects that"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["It's obviously applied on a very simple problem, but it will hopefully help you grasp what is at stake when we want to distribute content in a ",(0,i.jsx)(t.em,{children:"design-sensitive"})," way."]}),"\n",(0,i.jsx)(I,{}),"\n",(0,i.jsx)("br",{})]})}function F(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(R,{...e})}):R(e)}},2446:(e,t,s)=>{s.d(t,{A:()=>n});s(6540);var i=s(4848);const n=function(e){let{srcUrl:t,width:s=560,height:n=315,legend:a=""}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",margin:"auto",marginBottom:"30px"},children:(0,i.jsx)("iframe",{className:"illustration",width:s,height:n,src:t,frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}),(0,i.jsx)("p",{style:{fontSize:"small",textAlign:"center",marginTop:"-20px"},children:a})]})}},2929:(e,t,s)=>{s.d(t,{A:()=>a});s(6540);var i=s(6025),n=s(4848);const a=function(e){let{srcImage:t,legend:s="",altText:a="",halfWidth:r=!1}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{style:{width:"fit-content",display:"flex",margin:"auto",marginBottom:"30px"},children:(0,n.jsx)("img",{alt:a,style:{width:r?"400px":"auto",margin:"auto"},src:(0,i.A)(t)})}),(0,n.jsx)("p",{style:{fontSize:"small",textAlign:"center",marginTop:"-20px"},children:s})]})}},8453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>o});var i=s(6540);const n={},a=i.createContext(n);function r(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);