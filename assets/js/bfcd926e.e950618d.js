"use strict";(self.webpackChunkjb_blog=self.webpackChunkjb_blog||[]).push([[5690],{3905:(e,t,n)=>{n.d(t,{Zo:()=>h,kt:()=>p});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var o=a.createContext({}),c=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},h=function(e){var t=c(e.components);return a.createElement(o.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,s=e.originalType,o=e.parentName,h=l(e,["components","mdxType","originalType","parentName"]),d=c(n),u=i,p=d["".concat(o,".").concat(u)]||d[u]||m[u]||s;return n?a.createElement(p,r(r({ref:t},h),{},{components:n})):a.createElement(p,r({ref:t},h))}));function p(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var s=n.length,r=new Array(s);r[0]=u;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l[d]="string"==typeof e?e:i,r[1]=l;for(var c=2;c<s;c++)r[c]=n[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},8313:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(7294);const i=function(e){let{srcUrl:t,width:n=560,height:i=315,legend:s=""}=e;return a.createElement(a.Fragment,null,a.createElement("div",{style:{display:"flex",justifyContent:"center",margin:"auto",marginBottom:"30px"}},a.createElement("iframe",{className:"illustration",width:n,height:i,src:t,frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})),a.createElement("p",{style:{fontSize:"small",textAlign:"center",marginTop:"-20px"}},s))}},7993:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(7294),i=n(4996);const s=function(e){let{srcImage:t,legend:n="",altText:s="",halfWidth:r=!1}=e;return a.createElement(a.Fragment,null,a.createElement("div",{style:{width:"fit-content",display:"flex",margin:"auto",marginBottom:"30px"}},a.createElement("img",{alt:s,style:{width:r?"400px":"auto",margin:"auto"},src:(0,i.Z)(t)})),a.createElement("p",{style:{fontSize:"small",textAlign:"center",marginTop:"-20px"}},n))}},1957:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>H,contentTitle:()=>L,default:()=>F,frontMatter:()=>M,metadata:()=>P,toc:()=>B});var a=n(7462),i=n(7294),s=n(3905),r=n(5697),l=n.n(r),o=n(6486),c=n.n(o);class h{constructor(e,t){this.n=e,this.timeline=new Array(e),this.entropies=new Array(e),this.tiles=new Array(t.length),this.n_tiles=t.length;for(let n=0;n<t.length;n++){const a=t[n];this.tiles[n]={id:a.id,cid:a.cid,label:a.label,color:a.color,weights:new Array(e).fill(1)}}this.wave=new Array(e),this.wavefront=new Array(e).fill(!1),this.wave_save=new Array(e),this.constraints_propagator=[new Array(this.n_tiles).fill(new Array(this.n_tiles).fill(!0)),new Array(this.n_tiles).fill(new Array(this.n_tiles).fill(!0))],this.preferences_propagator=[],this.ready=!1,this.DEBUG_LOGS=!1}init(){this.setupWave()}getWave(){return this.wave}getTimeline(){return this.timeline}reset(){this.setupWave(),this.timeline=new Array(this.n)}resetConstraints(){this.constraints_propagator=[new Array(this.n_tiles).fill(new Array(this.n_tiles).fill(!0)),new Array(this.n_tiles).fill(new Array(this.n_tiles).fill(!0))]}setupWave(){this.wave=new Array(this.n),this.wavefront=new Array(this.n).fill(!1);for(let e=0;e<this.n;e++){this.wave[e]=[];for(let t=0;t<this.tiles.length;t++)this.tiles[t].weights[e]>0&&this.wave[e].push({id:this.tiles[t].id,cid:this.tiles[t].cid,label:this.tiles[t].label,color:this.tiles[t].color,weights:this.tiles[t].weights[e],distribution:0})}}setupPropagators(){this.constraints_propagator=[new Array(this.n_tiles).fill(new Array(this.n_tiles).fill(!0)),new Array(this.n_tiles).fill(new Array(this.n_tiles).fill(!0))]}applyConstraint(e,t,n){for(let a=0;a<e.length;a++)for(let i=0;i<n.length;i++)this.addConstraint(e[a],t,n[i])}addConstraint(e,t,n){this.constraints_propagator[t][e][n]=!1,this.constraints_propagator[(t+1)%2][n][e]=!1}resetWeights(){for(let e=0;e<this.tiles.length;e++)this.tiles[e].weights=new Array(this.n).fill(1)}applyWeight(e,t,n){for(let a=0;a<e.length;a++)this.tiles[e[a]].weights[t[0]]=n}computeEntropy(){for(let e=0;e<this.n;e++){if(this.wavefront[e]){this.entropies[e]=1e8;continue}const t=this.wave[e];let n=0;for(let e=0;e<t.length;e++)n+=t[e].weights;let a=0;for(let e=0;e<t.length;e++){const i=t[e].weights/n;t[e].distribution=i,0!==i&&(a-=i*Math.log(i))}this.entropies[e]=c().round(a,5)}}observe(){let e=Number.MAX_VALUE,t=-1,n=[];for(let a=0;a<this.n;a++){if(this.wavefront[a])continue;const i=this.entropies[a];i<e?(e=i,t=0,n=[a]):i===e&&n.push(a)}if(-1===t)throw console.error("ENTROPIES WRONGLY COMPUTED");return n[c().random(n.length-1)]}isDone(){let e=!0;for(let t=0;t<this.n;t++)if(!this.wavefront[t]){e=!1;break}return e}propagate(e,t){this.timeline[e]=this.wave[e][t];const n=this.wave[e][t].id;this.wave[e]=this.wave[e][t],this.wavefront[e]=!0;let a=0;if(e>0&&!1===this.wavefront[e-1]){const t=this.constraints_propagator[0][n];c().remove(this.wave[e-1],(function(e){return!t[e.id]&&(a+=1,!0)}))}if(e<this.n-1&&!1===this.wavefront[e+1]){const t=this.constraints_propagator[1][n];c().remove(this.wave[e+1],(function(e){return!t[e.id]&&(a+=1,!0)}))}return a}step(){this.computeEntropy();const e=this.observe(),t=function(e){let t=0,n=Math.random();for(;n>0;)n-=e[t].distribution,t++;return t--,t}(this.wave[e]),n=this.propagate(e,t);this.DEBUG_LOGS&&console.log(`The tile ${t} was placed at the spot ${e}, ${n} elements were removed from a potential spot during propagation`)}run(){for(;!this.isDone();)this.step()}slowRun(e){for(;!this.isDone();)setTimeout(this.step(),e)}}class d{constructor(e,t){this.n=e,this.timeline=new Array(e),this.deck=[...t],this.DEBUG_LOGS=!1}getTimeline(){return this.timeline}run(){for(let e=0;e<this.n;e++){const t=c().random(this.deck.length-1);this.timeline[e]=this.deck[t]}}}class m{constructor(e,t){this.n=e,this.timeline=new Array(e),this.deck=[...t],this.deck_save=[...t],this.DEBUG_LOGS=!1}reset(){this.deck=[...this.deck_save]}getTimeline(){return this.timeline}run(){for(let e=0;e<this.n;e++){const t=c().random(this.deck.length-1);this.timeline[e]=this.deck[t],c().pullAt(this.deck,[t])}}}class u{constructor(e,t){this.n=e,this.timeline=new Array(e),this.tiles=new Array(t.length);for(let n=0;n<t.length;n++){const e=t[n];this.tiles[n]={id:e.id,cid:e.cid,weight:1}}this.deck=[...t],this.DEBUG_LOGS=!1}reset(){this.timeline=new Array(this.n)}resetWeights(){for(let e=0;e<this.tiles.length;e++)this.tiles[e].weight=1}applyWeight(e,t){this.tiles[e].weight=t}resetWeight(e){this.tiles[e].weight=1}getTimeline(){return this.timeline}run(){let e=0;for(let t=0;t<this.tiles.length;t++)e+=this.tiles[t].weight;console.log(this.tiles),console.log(e);for(let t=0;t<this.n;t++){const n=c().random(e);let a=0;for(let e=0;e<this.tiles.length;e++)if(a+=this.tiles[e].weight,a>n){this.timeline[t]=this.tiles[e];break}}}}const p=20,g={cid:"00",label:"",color:"#fff"},f=["s","h","d","c"],y=["Spades","Hearts","Diamonds","Clubs"];function k(e,t){let n="";return n=11===t?"Jack of ":12===t?"Queen of ":13===t?"King of ":`${t} of `,n+=y[e],n}function v(e,t){let n="";return n=11===t?"J":12===t?"Q":13===t?"K":`${t}`,n+=f[e],n}const w=[];for(let R=0;R<4;R++)for(let e=1;e<14;e++)w.push({id:13*R+e-1,cid:v(R,e),label:k(R,e),color:"#868686"});new Array(p).fill(1),new Array(p).fill(1),new Array(p).fill(1),new Array(p).fill(1),new Array(p).fill(1),new Array(p).fill(1),new Array(p).fill(1);const b=[{key:"any",text:"Any",value:"0"},{key:"ace",text:"Ace",value:"1"},{key:"2",text:"2",value:"2"},{key:"3",text:"3",value:"3"},{key:"4",text:"4",value:"4"},{key:"5",text:"5",value:"5"},{key:"6",text:"6",value:"6"},{key:"7",text:"7",value:"7"},{key:"8",text:"8",value:"8"},{key:"9",text:"9",value:"9"},{key:"10",text:"10",value:"10"},{key:"jack",text:"Jack",value:"J"},{key:"queen",text:"Queen",value:"Q"},{key:"king",text:"King",value:"K"}],E=[{key:"0",text:"Suit",value:"0",color:"#495057"},{key:"s",text:"\u2660\ufe0f",value:"s",color:"black"},{key:"h",text:"\u2665\ufe0f",value:"h",color:"red"},{key:"h",text:"\u2666\ufe0f",value:"d",color:"red"},{key:"c",text:"\u2663\ufe0f",value:"c",color:"black"}],x=[{key:"0",text:"1",value:"0"},{key:"1",text:"2",value:"1"},{key:"2",text:"3",value:"2"},{key:"3",text:"4",value:"3"},{key:"4",text:"5",value:"4"},{key:"5",text:"6",value:"5"},{key:"6",text:"7",value:"6"},{key:"7",text:"8",value:"7"},{key:"8",text:"9",value:"8"},{key:"9",text:"10",value:"9"},{key:"10",text:"11",value:"10"},{key:"11",text:"12",value:"11"},{key:"12",text:"13",value:"12"},{key:"13",text:"14",value:"13"},{key:"14",text:"15",value:"14"},{key:"15",text:"16",value:"15"},{key:"16",text:"17",value:"16"},{key:"17",text:"18",value:"17"},{key:"18",text:"19",value:"18"},{key:"19",text:"20",value:"19"}],N=[{key:"type",text:"Type",value:"0"},{key:"no-after",text:"Can't be after",value:"no-after"},{key:"no-before",text:"Can't be before",value:"no-before"},{key:"only-after",text:"Must be after",value:"only-after"},{key:"only-before",text:"Must be before",value:"only-before"},{key:"no-at",text:"Can't be at spot",value:"no-at"},{key:"prefers-at",text:"Must be at spot",value:"prefers-at"}],C=["blue","green","orange","red"];function A(e){let{wave:t,mode:n=0}=e;return i.createElement("div",{className:"scroll timeline"},i.createElement("div",{className:"canvas"},i.createElement("div",{className:"line"}),t.map(((e,t)=>i.createElement("span",{key:`wave${t}`},i.createElement("span",null,i.createElement("div",{className:"slot",key:`t-${t}`,"data-tip":"Info about the genk dslkfjlsdkj <br> sfdldkj sdflkjfd sdlkdfj fskdshfez azoelk.","data-for":"calendar"},i.createElement("div",{className:"card-t"},i.createElement("card-t",{cid:e.cid,backtext:"",backcolor:C[n]})))))))))}A.propTypes={wave:l().array,mode:l().number,noir:l().bool};const T=e=>{let{title:t,onChange:n,id:a,width:s}=e;return i.createElement("label",{className:"switch-label",onClick:()=>n(a),style:{width:s}},t.split(/\s+/).map((e=>e[0].toUpperCase()+e.slice(1))).join(" "))};T.propTypes={title:l().string,onChange:l().func,id:l().number};const G=e=>{let{checked:t}=e;return i.createElement("input",{className:"switch-radio",type:"radio",name:"switch",checked:t,readOnly:!0})};G.propTypes={checked:l().bool};class D extends i.Component{state={selected:this.props.selected};handleChange=e=>{this.setState({selected:e}),this.props.handleSelect(e)};selectionStyle=()=>({left:this.state.selected/this.props.values.length*100+"%",width:100/this.props.values.length+"%"});render(){const{selected:e}=this.state;return i.createElement("div",{className:"switch"},this.props.values.map(((t,n)=>i.createElement("span",{className:"switch-container",key:t},i.createElement(G,{checked:e===n}),i.createElement(T,{title:t,onChange:this.handleChange,id:n,width:100/this.props.values.length+"%"})))),i.createElement("span",{className:"switch-selection",style:this.selectionStyle()}))}}D.propTypes={values:l().array,selected:l().number,handleSelect:l().func},D.defaultProps={values:["days","weeks","months"],selected:0};var S=n(7145),O=n.n(S);const W=e=>{let{mode:t}=e,n=null;return n=0===t?i.createElement("p",null,"At each position, we pick a card from a full 52-cards deck."):1===t?i.createElement("p",null,"At each position, we pick a card from a deck and we take out the card from the deck."):2===t?i.createElement("p",null,"At each position, we pick a card from a weighted deck we define.",i.createElement("br",null)," A card with weight 10 will have 10 times more chances to be picked than a card with weight 1."):i.createElement("p",null,"We apply a constraint-based algorithm (Wave Function Collapse) to distribute our cards.",i.createElement("br",null),"You can define the constraints below."),i.createElement("div",{className:"app-header"},n)};W.propTypes={mode:l().number};class $ extends i.Component{constructor(e){super(e),this.state={wave:new Array(p).fill(g),constraints:[[!0,"0","h","no-after","0","s","0"],[!0,"0","c","no-at","0","s","1"],[!0,"0","s","no-at","0","s","1"],[!0,"Q","d","prefers-at","0","s","0"],[!0,"1","s","no-after","1","0","0"]],weights:[[!0,"1","s",20],[!0,"5","d",5]],mode:0,configHasChanged:!0},this.N=p,this.data=w,this.gen=this.gen.bind(this),this.init=this.init.bind(this),this.reset=this.reset.bind(this),this.onConfigChange=this.onConfigChange.bind(this),this.onModeSelect=this.onModeSelect.bind(this),this.addConstraint=this.addConstraint.bind(this),this.removeConstraint=this.removeConstraint.bind(this),this.updateConstraint=this.updateConstraint.bind(this)}componentDidMount(){n.e(4219).then(n.t.bind(n,4219,23)),this.init()}gen(){const{mode:e,configHasChanged:t}=this.state;let n=null;0===e?(this.fullDeckGenerator.run(),n=this.fullDeckGenerator.getTimeline()):1===e?(this.normalDeckGenerator.reset(),this.normalDeckGenerator.run(),n=this.normalDeckGenerator.getTimeline()):2===e?(t&&(this.weightedDeckGenerator.resetWeights(),this.convertWeights()),this.weightedDeckGenerator.reset(),this.weightedDeckGenerator.run(),n=this.weightedDeckGenerator.getTimeline()):3===e&&(t?(this.wfcGenerator.resetWeights(),this.wfcGenerator.resetConstraints(),this.convertConstraints(),this.wfcGenerator.reset(),this.wfcGenerator.run(),n=this.wfcGenerator.getTimeline()):(this.wfcGenerator.reset(),this.wfcGenerator.run(),n=this.wfcGenerator.getTimeline())),this.setState({wave:n,configHasChanged:!1})}reset(){this.wfcGenerator.reset(),this.normalDeckGenerator.reset(),this.weightedDeckGenerator.reset(),this.setState({wave:new Array(this.N).fill(g)})}init(){this.wfcGenerator=new h(this.N,this.data),this.wfcGenerator.init(),this.fullDeckGenerator=new d(this.N,this.data),this.normalDeckGenerator=new m(this.N,this.data),this.weightedDeckGenerator=new u(this.N,this.data)}onConfigChange(e){this.N!==e.N?(this.N=e.N,this.setState({constraints:e.constraints,configHasChanged:!0},(()=>this.init()))):this.setState({constraints:e.constraints,configHasChanged:!0})}onModeSelect(e){this.setState({mode:e})}addWeight(){this.setState((e=>({weights:[...e.weights,[!1,"0","0",1]],configHasChanged:!0})))}removeWeight(e){this.setState({weights:O()(this.state.weights,{$splice:[[e,1]]}),configHasChanged:!0})}updateWeight(e,t,n){this.setState({weights:O()(this.state.weights,{[e]:{[t]:{$set:n}}}),configHasChanged:!0})}convertWeights(){const{weights:e}=this.state;for(let t=0;t<e.length;t++){const n=e[t];if(n[0])if("0"!==n[1]||"0"!==n[2])if("0"===n[1]&&"0"!==n[2])for(let e=0;e<this.data.length;e++)this.data[e].cid.charAt(1)===n[2]&&this.weightedDeckGenerator.applyWeight(this.data[e].id,n[3]);else if("0"!==n[1]&&"0"===n[2])for(let e=0;e<this.data.length;e++)this.data[e].cid.charAt(0)===n[1]&&this.weightedDeckGenerator.applyWeight(this.data[e].id,n[3]);else for(let e=0;e<this.data.length;e++)this.data[e].cid===`${n[1]}${n[2]}`&&this.weightedDeckGenerator.applyWeight(this.data[e].id,n[3]);else this.updateWeight(t,0,!1)}}addConstraint(){this.setState((e=>({constraints:[...e.constraints,[!1,"0","0","0","0","0"]],configHasChanged:!0})))}removeConstraint(e){this.setState({constraints:O()(this.state.constraints,{$splice:[[e,1]]}),configHasChanged:!0})}updateConstraint(e,t,n){this.setState({constraints:O()(this.state.constraints,{[e]:{[t]:{$set:n}}}),configHasChanged:!0})}convertConstraints(){const{constraints:e}=this.state;for(let t=0;t<e.length;t++){const n=e[t];if(!n[0])continue;let a=[],i=[],s=0,r=0,l=!1;switch(n[3]){case"no-after":s=0;break;case"no-before":s=1;break;case"only-after":l=!0,s=0;break;case"only-before":l=!0,s=1;break;case"no-at":s=2,r=0;break;case"prefers-at":s=2,r=1e4;break;default:this.updateConstraint(t,0,!1);continue}if(l){if("0"===n[1]&&"0"===n[2]){this.updateConstraint(t,0,!1);continue}if("0"===n[1]&&"0"!==n[2]){const e=c().filter(this.data,(e=>e.cid.charAt(1)!==n[2]));for(let t=0;t<e.length;t++)a.push(e[t].id)}else if("0"!==n[1]&&"0"===n[2]){const e=c().filter(this.data,(e=>e.cid.charAt(0)!==n[1]));for(let t=0;t<e.length;t++)a.push(e[t].id)}else{const e=c().filter(this.data,(e=>e.cid===`${n[1]}${n[2]}`));for(let t=0;t<e.length;t++)a.push(e[t].id)}}else{if("0"===n[1]&&"0"===n[2]){this.updateConstraint(t,0,!1);continue}if("0"===n[1]&&"0"!==n[2]){const e=c().filter(this.data,(e=>e.cid.charAt(1)===n[2]));for(let t=0;t<e.length;t++)a.push(e[t].id)}else if("0"!==n[1]&&"0"===n[2]){const e=c().filter(this.data,(e=>e.cid.charAt(0)===n[1]));for(let t=0;t<e.length;t++)a.push(e[t].id)}else{const e=c().findIndex(this.data,(e=>e.cid===`${n[1]}${n[2]}`));a.push(this.data[e].id)}}if(s<2){if("0"===n[4]&&"0"===n[5]){this.updateConstraint(t,0,!1);continue}if("0"===n[4]&&"0"!==n[5]){const e=c().filter(this.data,(e=>e.cid.charAt(1)===n[5]));for(let t=0;t<e.length;t++)i.push(e[t].id)}else if("0"!==n[4]&&"0"===n[5]){const e=c().filter(this.data,(e=>e.cid.charAt(0)===n[4]));for(let t=0;t<e.length;t++)i.push(e[t].id)}else{const e=c().findIndex(this.data,(e=>e.cid===`${n[4]}${n[5]}`));i.push(this.data[e].id)}}else i.push(parseInt(n[6]));s<2?this.wfcGenerator.applyConstraint(a,s,i):this.wfcGenerator.applyWeight(a,i,r)}}render(){const{wave:e,configHasChanged:t,mode:n,constraints:a,weights:s}=this.state;return i.createElement(i.Fragment,null,i.createElement("div",{className:"app-container"},i.createElement(D,{values:["Many full decks","One deck distributed","Weighted decks","Constrained decks"],selected:n,handleSelect:this.onModeSelect}),i.createElement(W,{mode:n}),i.createElement(A,{wave:e,mode:n}),i.createElement("div",{className:"buttons"},i.createElement("button",{className:"reset run",onClick:this.reset},i.createElement("span",null,"RESET")),i.createElement("button",{className:"run",onClick:this.gen},i.createElement("span",null,"GEN"),t&&2===n?i.createElement("span",{className:"warn"},"!"):i.createElement(i.Fragment,null))),i.createElement("div",{className:"constraints-container",hidden:2!==n},i.createElement("h3",null,"Weights definition"),i.createElement("div",{className:"constraints"},i.createElement("div",{className:"constraints-line firstLine"},i.createElement("div",{className:"number"},"#"),i.createElement("div",{className:"use"},"Use"),i.createElement("div",{className:"selector"},"Selector"),i.createElement("div",{className:"weight"},"Weight")),s.map(((e,t)=>i.createElement("div",{className:"constraints-line midLine",key:`w-key-${t}`},i.createElement("div",{className:"number"},"#",t+1),i.createElement("div",{className:"use"},i.createElement("input",{type:"checkbox",checked:e[0],onChange:e=>this.updateWeight(t,0,e.target.checked)})),i.createElement("div",{className:"selector"},i.createElement("select",{className:"select-text",value:e[1],onChange:e=>this.updateWeight(t,1,e.target.value)},b.map((e=>i.createElement("option",{key:`w-${e.key}`,value:e.value},e.text)))),i.createElement("select",{value:e[2],onChange:e=>this.updateWeight(t,2,e.target.value),style:{color:"h"===e[2]||"d"===e[2]?"red":"inherit"}},E.map(((e,n)=>i.createElement("option",{key:`w-${e.key}-${t}-${n}`,value:e.value,style:{color:e.color}},e.text))))),i.createElement("div",{className:"weight"},i.createElement("input",{type:"number",min:"0",value:e[3],onChange:e=>this.updateWeight(t,3,e.target.valueAsNumber)})),i.createElement("div",{className:"remove"},i.createElement("button",{style:{borderRadius:"200px",padding:0,paddingBottom:"2px",width:"28px"},onClick:()=>this.removeWeight(t)},"-"))))),i.createElement("div",{className:"constraints-line lastLine"},i.createElement("button",{onClick:()=>this.addWeight()},"Add constraint")))),i.createElement("div",{className:"constraints-container",hidden:3!==n},i.createElement("h3",null,"Constraints definition"),i.createElement("div",{className:"constraints"},i.createElement("div",{className:"constraints-line firstLine"},i.createElement("div",{className:"number"},"#"),i.createElement("div",{className:"use"},"Use"),i.createElement("div",{className:"selector"},"Selector"),i.createElement("div",{className:"type"},"Constraint type"),i.createElement("div",{className:"selector"},"Selector"),i.createElement("div",{className:"remove"},"Suppr.")),a.map(((e,t)=>i.createElement("div",{className:"constraints-line midLine",key:`key-${t}`},i.createElement("div",{className:"number"},"#",t+1),i.createElement("div",{className:"use"},i.createElement("input",{type:"checkbox",checked:e[0],onChange:e=>this.updateConstraint(t,0,e.target.checked)})),i.createElement("div",{className:"selector"},i.createElement("select",{className:"select-text",value:e[1],onChange:e=>this.updateConstraint(t,1,e.target.value)},b.map(((e,n)=>i.createElement("option",{key:`${e.key}-${t}-${n}`,value:e.value},e.text)))),i.createElement("select",{value:e[2],onChange:e=>this.updateConstraint(t,2,e.target.value),style:{color:"h"===e[2]||"d"===e[2]?"red":"inherit"}},E.map(((e,n)=>i.createElement("option",{key:`${e.key}-${t}-${n}`,value:e.value,style:{color:e.color}},e.text))))),i.createElement("div",{className:"type"},i.createElement("select",{value:e[3],onChange:e=>this.updateConstraint(t,3,e.target.value)},N.map((e=>i.createElement("option",{key:e.key,value:e.value},e.text))))),"no-at"!==e[3]&&"prefers-at"!==e[3]?i.createElement("div",{className:"selector"},i.createElement("select",{className:"select-text",value:e[4],onChange:e=>this.updateConstraint(t,4,e.target.value)},b.map(((e,n)=>i.createElement("option",{key:`2-${e.key}-${t}-${n}`,value:e.value},e.text)))),i.createElement("select",{value:e[5],onChange:e=>this.updateConstraint(t,5,e.target.value),style:{color:"h"===e[5]||"d"===e[5]?"red":"inherit"}},E.map(((e,n)=>i.createElement("option",{key:`2-${e.key}-${t}-${n}`,value:e.value,style:{color:e.color}},e.text))))):i.createElement("div",{className:"selector"},i.createElement("select",{value:e[6],onChange:e=>this.updateConstraint(t,6,e.target.value)},x.map((e=>i.createElement("option",{key:e.key,value:e.value},e.text))))),i.createElement("div",{className:"remove"},i.createElement("button",{style:{borderRadius:"200px",padding:0,paddingBottom:"2px",width:"28px"},onClick:()=>this.removeConstraint(t)},"-"))))),i.createElement("div",{className:"constraints-line lastLine"},i.createElement("button",{onClick:()=>this.addConstraint()},"Add constraint"))))))}}const _=$;var j=n(7993),I=n(8313);const M={slug:"content-distribution",title:"Designing randomness: when generation is distribution",draft:!1,tags:["designing randomness","procedural","game design","tools"]},L=void 0,P={permalink:"/blog/content-distribution",source:"@site/blog/2021-07-01-content-distribution.md",title:"Designing randomness: when generation is distribution",description:"Let's distribute cards. But better.",date:"2021-07-01T00:00:00.000Z",formattedDate:"July 1, 2021",tags:[{label:"designing randomness",permalink:"/blog/tags/designing-randomness"},{label:"procedural",permalink:"/blog/tags/procedural"},{label:"game design",permalink:"/blog/tags/game-design"},{label:"tools",permalink:"/blog/tags/tools"}],readingTime:3.81,hasTruncateMarker:!0,authors:[],frontMatter:{slug:"content-distribution",title:"Designing randomness: when generation is distribution",draft:!1,tags:["designing randomness","procedural","game design","tools"]},prevItem:{title:"The quintillions of different runs in Hades (and why it doesn't matter)",permalink:"/blog/arrangements-hell-hades"},nextItem:{title:"Designing information: why is it hard to communicate science",permalink:"/blog/science-popularization"}},H={authorsImageUrls:[]},B=[],U={toc:B},Z="wrapper";function F(e){let{components:t,...n}=e;return(0,s.kt)(Z,(0,a.Z)({},U,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"Let's distribute cards. But better."),(0,s.kt)("hr",null),(0,s.kt)("p",null,(0,s.kt)("em",{parentName:"p"},(0,s.kt)("strong",{parentName:"em"},"Procedural generation"))," is a term probably overused in videogame production. It's so trendy, it makes your system sound so smart where you often just call ",(0,s.kt)("inlineCode",{parentName:"p"},"random()")," a bunch of times."),(0,s.kt)(j.Z,{srcImage:"img/illustrations/wiki-procedural.png",altText:"wiki-procedural",legend:"Randomly generated redirects here. Oof.",mdxType:"Image"}),(0,s.kt)("p",null,"I personally see ",(0,s.kt)("em",{parentName:"p"},(0,s.kt)("strong",{parentName:"em"},"procedural generation"))," as a glorified name to designate ",(0,s.kt)("strong",{parentName:"p"},"a function with a small input that spits out a big output"),". And for me, this is the whole point: from a minimal set of handcrafted parameters, get the maximal results you can thanks to a ",(0,s.kt)("em",{parentName:"p"},"procedure"),", an ",(0,s.kt)("em",{parentName:"p"},"algorithm"),", a ",(0,s.kt)("em",{parentName:"p"},"piece of code"),", ... to avoid doing everything yourself."),(0,s.kt)("p",null,"If ",(0,s.kt)("em",{parentName:"p"},(0,s.kt)("strong",{parentName:"em"},"procedural generation"))," is already ubiquitous in the art pipelines of most videogame/VFX/animation studio, it has also lived in the realm of game design for a long time."),(0,s.kt)("p",null,"In this ",(0,s.kt)("a",{parentName:"p",href:"/blog/tags/designing-randomness"},"series of short articles")," called ",(0,s.kt)("em",{parentName:"p"},(0,s.kt)("strong",{parentName:"em"},"Designing randomness")),", I dive into the field of ",(0,s.kt)("strong",{parentName:"p"},"procedural game design"),"."),(0,s.kt)("hr",null),(0,s.kt)("p",null,"In game design, ",(0,s.kt)("em",{parentName:"p"},(0,s.kt)("strong",{parentName:"em"},"procedural generation"))," is often focused on ",(0,s.kt)("em",{parentName:"p"},(0,s.kt)("strong",{parentName:"em"},"generating game content"))," : making an infinite amount of dungeons for the player to explore in a roguelike is the quintessential example, so let's take it."),(0,s.kt)("p",null,"Dungeons in roguelikes are not generated through some kind of superpowerful algorithm, redrawing every position of every brick to create a new yet coherent piece of architecture. The problem is much simpler, and it starts with defining a dungeon from a level design perspective:"),(0,s.kt)("p",{style:{textAlign:"center",fontWeight:"bold",marginTop:"20px",fontSize:"18px"}},"99,9% of the time, a dungeon is an assemblage of pre-made rooms."),(0,s.kt)("p",null,"Generating a dungeon then becomes choosing rooms from an existing library and linking rooms with doors. Much better!"),(0,s.kt)("br",null),(0,s.kt)(I.Z,{srcUrl:"https://www.youtube.com/embed/1-HIA6-LBJc",legend:"The original programmer of Binding of Isaac on the Room Generation algorithm he conceived for the game",mdxType:"Iframe"}),(0,s.kt)("br",null),(0,s.kt)("p",null,"This subspace of procedural generation, ",(0,s.kt)("em",{parentName:"p"},(0,s.kt)("strong",{parentName:"em"},"distributing pre-existing content")),", is well adapted to most designers' needs. Thus, design tasks are split in two layers: ",(0,s.kt)("strong",{parentName:"p"},"designing individuals rooms")," to serve the second to second gameplay, ",(0,s.kt)("strong",{parentName:"p"},"designing the rules of assemblage")," to serve the minute to minute exploration of our dungeon."),(0,s.kt)("p",null,"This second layer is where procedural game design takes center stage: the ",(0,s.kt)("strong",{parentName:"p"},"use of randomness is essential")," to keep the world fresh and unpredictible for players, but we still need ",(0,s.kt)("strong",{parentName:"p"},"a level of control on the assemblage algorithm to inject level design rules")," (for pacing, logic, avoiding repetition). Easier said than done! Striking a design balance between the predictability of rules and the impredictability of their random use is key to generate endless amounts of enjoyable dungeons."),(0,s.kt)("br",null),(0,s.kt)(I.Z,{srcUrl:"https://www.youtube.com/embed/ClZe5x8Tfiw",legend:"Hades world structure uses this exact principle: a series of rooms that you cross one after the other!",mdxType:"Iframe"}),(0,s.kt)("br",null),(0,s.kt)("hr",null),(0,s.kt)("p",null,"Let's simplify the problem a bit more: ",(0,s.kt)("strong",{parentName:"p"},"let's say our dungeon is a straight corridor of 20 rooms back to back"),". Our brave designer created a library of 52 rooms that can be represented by the usual poker cards. I like the card representation because I think it mimics well ",(0,s.kt)("em",{parentName:"p"},"the reality of content development"),": you have ",(0,s.kt)("strong",{parentName:"p"},"many ways to subdivide a given set"),". In the case of cards: ",(0,s.kt)("strong",{parentName:"p"},"suit, color, value, figures"),"."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"This next interactive toy lets you play with 4 different ways to distribute 20 ordered cards"),", 4 different ways to build a dungeon, from dumb to smart, from dead simple to not-so-simple."),(0,s.kt)("p",null,"With the last one, I tried to strike the balance between random and rules I talked earlier by using a ",(0,s.kt)("strong",{parentName:"p"},"constraint based algorithm (the popular Wave Function Collapse): it's often simpler to say to the computer what you don't want and then let it generate something that respects that"),"."),(0,s.kt)("p",null,"It's obviously applied on a very simple problem, but it will hopefully help you grasp what is at stake when we want to distribute content in a ",(0,s.kt)("em",{parentName:"p"},"design-sensitive")," way."),(0,s.kt)(_,{mdxType:"ContentDistribution"}),(0,s.kt)("br",null))}F.isMDXComponent=!0}}]);